<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>üèÜ Sieger ‚Äì Fotowettbewerb {{ year }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding-top: 60px; background: linear-gradient(135deg, #ffe3ec 0%, #ffc2d1 50%, #ffb3c6 100%); }
        .podium-wrapper { display:flex; justify-content:center; align-items:flex-end; gap:20px; margin-top:50px; flex-wrap:wrap; }
        .image-card { width:180px; border:none; border-radius:10px; background:#fff; box-shadow:0 4px 20px rgba(255,133,173,.3); padding:10px; text-align:center; }
        .image-card img { width:100%; height:180px; object-fit:cover; border-radius:6px; }
        .uploader { font-weight:bold; font-size:.9rem; margin-top:6px; }
        .step { width:180px; background:#fff; border-radius:4px 4px 0 0; text-align:center; font-weight:bold; padding-top:8px; color:#495057; }
        .step-1 { height:200px; order:2; }
        .step-2 { height:120px; order:1; }
        .step-3 { height:80px; order:3; }
        .medal { font-size:28px; }
        #winner-stickers{ position:fixed; inset:0; pointer-events:none; z-index:30; }
        #winner-stickers img{ position:absolute; width:70px; opacity:.9; }
    </style>
</head>
<body>
<div id="winner-stickers"></div>
<div class="container text-center px-3">
    <h1 class="mb-5">ü•á Die besten Bilder {{ year }}</h1>

    {% if top_images|length >= 3 %}
    <div class="podium-wrapper">
        <div class="text-center">
            <div class="image-card">
                <img src="{{ url_for('main.media_year', year=year, filename=top_images[1].filename) }}" alt="Platz 2">
                <div class="medal">ü•à</div>
                <div class="uploader">{{ top_images[1].uploader or 'Unbekannt' }}</div>
            </div>
            <div class="step step-2">2. Platz</div>
        </div>
        <div class="text-center">
            <div class="image-card">
                <img src="{{ url_for('main.media_year', year=year, filename=top_images[0].filename) }}" alt="Platz 1">
                <div class="medal">ü•á</div>
                <div class="uploader">{{ top_images[0].uploader or 'Unbekannt' }}</div>
            </div>
            <div class="step step-1">1. Platz</div>
        </div>
        <div class="text-center">
            <div class="image-card">
                <img src="{{ url_for('main.media_year', year=year, filename=top_images[2].filename) }}" alt="Platz 3">
                <div class="medal">ü•â</div>
                <div class="uploader">{{ top_images[2].uploader or 'Unbekannt' }}</div>
            </div>
            <div class="step step-3">3. Platz</div>
        </div>
    </div>
    {% endif %}
</div>

<script>
fetch('/api/stickers/{{ year }}').then(res => res.json()).then(stickers => {
    if (!stickers || !stickers.length) return;
    const container = document.getElementById('winner-stickers');
    const total = Math.min(18, stickers.length);
    for (let i = 0; i < total; i++) {
        const img = document.createElement('img');
        const file = stickers[Math.floor(Math.random() * stickers.length)];
        img.src = `/sticker/{{ year }}/${file}`;
        img.style.left = `${Math.random() * 95}%`;
        img.style.top = `${Math.random() * 90}%`;
        container.appendChild(img);
    }
}).catch(() => {});
</script>
</body>
</html>